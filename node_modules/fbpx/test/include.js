'use strict';

/* global describe, it */

var chai = require('chai');
var createParser = require('./helper').createParser;
var fs = require('fs');

describe('With a graph containing an include', function () {
  var fbpData, graphData;

  var parser = createParser();

  describe('the generated graph', function () {

    it('should be able to include the the file as string', function () {
      fbpData = fs.readFileSync('test/fixtures/include.fbp');
      graphData = parser.parse(fbpData);
      chai.expect(graphData.nodes[0]).to.eql({
        id: 'Repeat',
        title: 'Repeat',
        ns: 'test',
        name: 'repeat',
        context: { in : '{ "test": "ing" }'
        }
      });
    });

    it('should be able to include the the file as json', function () {
      fbpData = fs.readFileSync('test/fixtures/include!.fbp');
      graphData = parser.parse(fbpData);
      chai.expect(graphData.nodes[0]).to.eql({
        id: 'Repeat',
        title: 'Repeat',
        ns: 'test',
        name: 'repeat',
        context: { in : {
            test: 'ing'
          }
        }
      });
    });

  });
});